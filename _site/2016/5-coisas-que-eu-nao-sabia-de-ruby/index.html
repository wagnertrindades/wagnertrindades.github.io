<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>5 coisas que eu não sabia de Ruby</title>
  <meta name="description" content="Web Developer">
  <meta name="author" content="Wagner Trindade">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Wagner Trindade">
  <meta name="twitter:description" content="Web Developer">

  <meta property="og:type" content="article">
  <meta property="og:title" content="Wagner Trindade">
  <meta property="og:description" content="Web Developer">

  <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://wagnertrindades.github.io//2016/5-coisas-que-eu-nao-sabia-de-ruby/">
  <link rel="alternate" type="application/rss+xml" title="Wagner Trindade" href="/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>

<header class="panel-cover" style="background-image: url(/images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/" title="link to home of Wagner Trindade">
          <img src="/images/profile.jpg" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">Wagner Trindade</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">Web Developer</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <!--
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="link to Wagner Trindade blog" class="blog-button">Blog</a></li>
            </ul>
            -->
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">

            
              <!-- Twitter -->
              <li class="navigation__item">
                <a href="http://twitter.com/WagnerTrindades" title="@WagnerTrindades on Twitter" target="_blank">
                  <i class="icon icon-social-twitter"></i>
                  <span class="label">Twitter</span>
                </a>
              </li>
            

            
              <!-- Facebook -->
              <li class="navigation__item">
                <a href="http://fb.me/wagner.trindade.9" title="wagner.trindade.9 on Facebook" target="_blank">
                  <i class="icon icon-social-facebook"></i>
                  <span class="label">Facebook</span>
                </a>
              </li>
            

            
              <!-- LinkedIn -->
              <li class="navigation__item">
                <a href="https://www.linkedin.com/in/wagner-trindade-sanseverino-2592279a" title="wagner-trindade-sanseverino-2592279a on LinkedIn" target="_blank">
                  <i class="icon icon-social-linkedin"></i>
                  <span class="label">LinkedIn</span>
                </a>
              </li>
            

            
              <!-- GitHub -->
              <li class="navigation__item">
                <a href="https://www.github.com/wagnertrindades" title="wagnertrindades on GitHub" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>
            

            
              <!-- Email -->
              <li class="navigation__item">
                <a href="mailto:wtrindades@gmail.com" title="Email wtrindades@gmail.com" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>
            

            <!-- RSS -->
            <li class="navigation__item">
              <a href="/feed.xml" title="Subscribe" target="_blank">
                <i class="icon icon-rss"></i>
                <span class="label">RSS</span>
              </a>
            </li>

            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="25 Jul 2016" class="post-meta__date date">25 Jul 2016</time> &#8226; <span class="post-meta__tags">on <a href="/tags/#ruby">ruby</a> </span>
    </div>
    <h1 class="post-title">5 coisas que eu não sabia de Ruby</h1>
  </header>

  <section class="post">
    <h3 id="introduo">Introdução</h3>

<h2 id="diferena-entre-symbol-e-string">Diferença entre :Symbol e “String”</h2>

<p>A primeira coisa que me deixou bem curioso e que começei a pesquisar um
pouco mais sobre foi a questão de termos o <strong>Symbol</strong> e a <strong>String</strong> que
teoricamente são muito parecidos.</p>

<p>Então quando usar um ou outro?
Sempre utilizei mais Strings no geral
porém será que tem algum momento que seria melhor eu ter utilizado um
Symbol?
Realmente a uma diferença dos dois ou é somente a sintaxe?</p>

<p>Bom, vamos ver com os exemplos abaixo:</p>

<p><strong>:Symbol</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="ss">:xunda</span>
<span class="o">=&gt;</span> <span class="ss">:xunda</span>

<span class="n">b</span> <span class="o">=</span> <span class="ss">:xunda</span>
<span class="o">=&gt;</span> <span class="ss">:xunda</span>

<span class="n">a</span><span class="p">.</span><span class="nf">object_id</span>
<span class="o">=&gt;</span> <span class="mi">1154268</span>

<span class="n">b</span><span class="p">.</span><span class="nf">object_id</span>
<span class="o">=&gt;</span> <span class="mi">1154268</span>
</code></pre>
</div>

<p>Como pode ver acima através do método <code class="highlighter-rouge">object_id</code> conseguimos saber
exatamente a posição em memória de cada objeto, no caso as
variáveis <em>a</em> e <em>b</em> que são os symbols com os mesmos caracteres.</p>

<p>Então concluimos que <strong>Symbols</strong> com os mesmos caracteres mesmo que em diferentes variáveis
ou qualquer outro lugar no código são um <strong>único objeto</strong></p>

<p><strong>“String”</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="s2">"xunda"</span>
<span class="o">=&gt;</span> <span class="s2">"xunda"</span>

<span class="n">b</span> <span class="o">=</span> <span class="s2">"xunda"</span>
<span class="o">=&gt;</span> <span class="s2">"xunda"</span>

<span class="n">a</span><span class="p">.</span><span class="nf">object_id</span>
<span class="o">=&gt;</span> <span class="mi">6990405680384</span>

<span class="n">b</span><span class="p">.</span><span class="nf">object_id</span>
<span class="o">=&gt;</span> <span class="mi">6990405442200</span>
</code></pre>
</div>

<p>Já com as strings o resultado não é o mesmo, vemos que os números de
onde foi alocado o espaço em memória para cada string são diferentes
logo não se trata do mesmo objeto.</p>

<p>Então duas <strong>Strings</strong> mesmo tendo os mesmos caracteres são dois <strong>objetos
diferentes</strong></p>

<h4 id="legal-mas-o-que-isso-muda-na-minha-vida-kkk">Legal, mas o que isso muda na minha vida? kkk</h4>

<p>Bom sabendo sobre essa diferença conseguimos concluir que toda
vez que criar uma nova string embora seja os mesmos caracteres estará
instanciando um novo objeto em memória e ocupando mais um novo espaço em
memória.</p>

<p>E quando tiver trabalhando com symbols caso seja os mesmos caracteres
você esta economizando espaço em memória já que não instancia o objeto
novamente apenas utiliza o mesmo objeto já instanciado em memória
então não consome mais memória.</p>

<p>Então vou utilizar somente os maravilhos <strong>Symbols</strong> e ser feliz para
sempre???</p>

<blockquote>
  <p>Gif Jim Carrey?</p>
</blockquote>

<p>Humm, acho que não…</p>

<p>Vamos ver abaixo um pouco mais sobre essa questão de armazenamento em
memória</p>

<h3 id="garbage-collector">Garbage Collector</h3>

<p>https://www.infoq.com/br/presentations/entendendo-garbage-collector-ruby</p>

<blockquote>
  <p>Falar o que é Garbage Collector</p>
</blockquote>

<blockquote>
  <p>Explicar que o Symbol apesar de ser mais rápido e ocupar menos espaço em
memória não é coletado pelo garbage collector o que pode causar um
sistema mais lento caso tenha diversos Symbols em memória que ficam
alocados em memória “para sempre”</p>
</blockquote>

<h3 id="concluso">Conclusão</h3>

<blockquote>
  <p>Use os saiba usa-los de acordo com cada caso</p>
</blockquote>

<h2 id="cuidado-com-floats">Cuidado com Floats</h2>

<p>Uma coisa que no próprio livro alertou e que até então num tinha visto
que acontecia esse tipo de coisa com o Float.</p>

<p><strong>Float</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="mi">0</span><span class="o">.</span><span class="mo">0004</span> <span class="o">-</span> <span class="mi">0</span><span class="o">.</span><span class="mo">0003</span> <span class="o">==</span> <span class="mi">0</span><span class="o">.</span><span class="mo">0001</span>
<span class="o">=&gt;</span> <span class="kp">false</span>

<span class="mi">0</span><span class="o">.</span><span class="mo">0004</span> <span class="o">-</span> <span class="mi">0</span><span class="o">.</span><span class="mo">0003</span>
<span class="o">=&gt;</span> <span class="mi">0</span><span class="o">.</span><span class="mo">0010000000000000005</span>
</code></pre>
</div>
<hr />
<p><img src="/images/posts/2016-07-25-5-coisas-que-eu-sabia-de-ruby/ish.jpg" alt="ish" /></p>

<p>WTF!?!?</p>

<hr />

<hr />
<p>Quando vi até lembrei desse
video que já ficou famoso a algum tempo atrás kkk</p>

<iframe width="420" height="315" src="https://www.youtube.com/embed/0MR_Jw0QVQ4" frameborder="0" allowfullscreen=""></iframe>
<hr />

<p>Isso ocorre porque a representação de números reais usada é o IEEE-754,
a forma padrão de representar números reais em binários, que não é
somente utilizada pelo Ruby, mas também por C, Java e Javascript. Porém,
este padrão possui um problema perigoso de arredondamento causando esse
tipo de resultado.</p>

<p>Muitas pessoas por desconhecerem esse problema podem usar floats para valores
financeiros, o que certamente vai ocosionar vários desses erros.
Para isso, usa-se a classe BigDecimal, do conjunto de bibliotecas padrão
do Ruby.</p>

<p><strong>BigDecimal</strong></p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nb">require</span> <span class="s1">'bigdecimal'</span>
<span class="o">=&gt;</span> <span class="kp">true</span>

<span class="n">num1</span> <span class="o">=</span> <span class="no">BigDecimal</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"0.0004"</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="c1">#&lt;BigDecimal:7f6961d47328, '0.4E-3',9(18)&gt;</span>

<span class="n">num2</span> <span class="o">=</span> <span class="no">BigDecimal</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"0.0003"</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="c1">#&lt;BigDecimal:7f6961d98237, '0.3E-3',9(18)&gt;</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">num1</span> <span class="o">-</span> <span class="n">num2</span>
<span class="o">=&gt;</span> <span class="c1">#&lt;BigDecimal:7f6961d83vc3, '0.1E-3',9(18)&gt;</span>

<span class="n">result</span><span class="p">.</span><span class="nf">to_s</span><span class="p">(</span><span class="s1">'F'</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="s2">"0.0001"</span>
</code></pre>
</div>

<p>Apesar de ser muito mais lenta que floats, eles são precisos e
se tratando de cálculos financeiros, performance na maioria dos casos
não é um problema, se comparado com aplicações científicas.</p>

<h3 id="concluso-1">Conclusão</h3>

<p>Como visto no video o muleke errando todas as contas de matemática rsrs
E quando perguntam para ele…
Quem te ensinou?…
Meu professor de <strong>ciências</strong>…</p>

<p>Ai está o erro rsrs, sempre pergunte para o professor certo…</p>

<p>Se vai trabalhar com números com poucas casas decimais e não é
necessário tanta precisão com certeza é melhor utilizar os Floats mesmo
assim consegue ter mais performace e é mais comum a utilização. Mas caso
for trabalhar com cálculos financeiros ou caso precise de uma boa
precisão com números de várias casas decimais  com certeza teras que utlizar
BigDecimal.</p>

<h2 id="diferenas-entre-proc-e-lambda">Diferenças entre Proc e Lambda</h2>

<h3 id="primeira-diferena">Primeira diferença</h3>

<h4 id="proc">Proc</h4>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">show</span> <span class="o">=</span> <span class="nb">proc</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">|</span> <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">y</span><span class="si">}</span><span class="s2">"</span> <span class="p">}</span>
<span class="o">=&gt;</span> <span class="c1">#&lt;Proc:0x817487288372487@(irb):8&gt;</span>

<span class="n">show</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="o">=&gt;</span> <span class="kp">nil</span>

<span class="n">show</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="mi">1</span><span class="p">,</span>
<span class="o">=&gt;</span> <span class="kp">nil</span>

<span class="n">show</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="o">=&gt;</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Como podemos ver acima apesar de no <code class="highlighter-rouge">Proc</code> termos definido trabalhar com
2 parametros no caso <em>x</em> e <em>y</em>, podemos passar somente um parametro ou 3
parametros que ele irá imprimir o que conseguir sem nem reclamar rsrs.</p>

<p>Já com Lambda é um pouco diferente, vamos ver abaixo:</p>

<h4 id="lambda">Lambda</h4>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">show</span> <span class="o">=</span> <span class="nb">lambda</span> <span class="p">{</span> <span class="o">|</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">|</span> <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">#{</span><span class="n">y</span><span class="si">}</span><span class="s2">"</span> <span class="p">}</span>
<span class="o">=&gt;</span> <span class="c1">#&lt;Proc:0x8174872882137@(irb):4 (lambda)&gt;</span>

<span class="n">show</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="o">=&gt;</span> <span class="kp">nil</span>

<span class="n">show</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="no">ArgumentError</span><span class="p">:</span> <span class="n">wrong</span> <span class="n">number</span> <span class="n">of</span> <span class="n">arguments</span> <span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">from</span> <span class="p">(</span><span class="n">irb</span><span class="p">):</span><span class="mi">4</span><span class="ss">:in</span> <span class="sb">`block in irb_binding`</span>
        <span class="n">from</span> <span class="p">(</span><span class="n">irb</span><span class="p">):</span><span class="mi">6</span><span class="ss">:in</span> <span class="sb">`call`</span>
        <span class="n">from</span> <span class="p">(</span><span class="n">irb</span><span class="p">):</span><span class="mi">6</span>
        <span class="n">from</span> <span class="sr">/home/</span><span class="n">rd</span><span class="o">/</span><span class="p">.</span><span class="nf">rbenv</span><span class="o">/</span><span class="n">versions</span><span class="o">/</span><span class="mi">2</span><span class="o">.</span><span class="mi">2</span><span class="o">.</span><span class="mi">2</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">irb</span><span class="p">:</span><span class="mi">11</span><span class="ss">:in</span> <span class="sb">`&lt;main&gt;`</span>

<span class="n">show</span><span class="p">.</span><span class="nf">call</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="no">ArgumentError</span><span class="p">:</span> <span class="n">wrong</span> <span class="n">number</span> <span class="n">of</span> <span class="n">arguments</span> <span class="p">(</span><span class="mi">3</span> <span class="k">for</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">from</span> <span class="p">(</span><span class="n">irb</span><span class="p">):</span><span class="mi">4</span><span class="ss">:in</span> <span class="sb">`block in irb_binding`</span>
        <span class="n">from</span> <span class="p">(</span><span class="n">irb</span><span class="p">):</span><span class="mi">7</span><span class="ss">:in</span> <span class="sb">`call`</span>
        <span class="n">from</span> <span class="p">(</span><span class="n">irb</span><span class="p">):</span><span class="mi">7</span>
        <span class="n">from</span> <span class="sr">/home/</span><span class="n">rd</span><span class="o">/</span><span class="p">.</span><span class="nf">rbenv</span><span class="o">/</span><span class="n">versions</span><span class="o">/</span><span class="mi">2</span><span class="o">.</span><span class="mi">2</span><span class="o">.</span><span class="mi">2</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">irb</span><span class="p">:</span><span class="mi">11</span><span class="ss">:in</span> <span class="sb">`&lt;main&gt;`</span>

</code></pre>
</div>

<p>Fazendo o mesmo com um <code class="highlighter-rouge">Lambda</code> ele já reclama que não consegue executar
caso não passe exatamente os parametros que definiu em sua criação.</p>

<p>Dessa forma vemos que o Proc não valida a quantidade de parametros
passados pois permite passar inumeros parametros e ele
tenta executar com o que foi passado.Já o Lambda não permite isso, ele
valida se o número de parametros é exatamente o mesmo.</p>

<p>Bom essa é a primeira diferença entre eles, mas vamos a segunda:</p>

<h3 id="segunda-diferena">Segunda diferença</h3>

<h4 id="proc-1">Proc</h4>

<p>Bom quando temos um Proc dentro de um método e dentro do Proc há um
<code class="highlighter-rouge">return</code>, esse return para a execução do método associado ao Proc
fazendo com que a linhas após o <code class="highlighter-rouge">return</code> do Proc não sejam executadas.
Como pode ver no exemplo abaixo:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">proc_stop</span>
  <span class="nb">puts</span> <span class="s2">"Cheguei..."</span>
  <span class="nb">proc</span> <span class="p">{</span> <span class="nb">puts</span> <span class="s2">"Hey"</span><span class="p">;</span> <span class="k">return</span><span class="p">;</span> <span class="nb">puts</span> <span class="s2">"Ho!"</span> <span class="p">}.</span><span class="nf">call</span>
  <span class="nb">puts</span> <span class="s2">"Saindo..."</span>
<span class="k">end</span>

<span class="n">proc_stop</span> <span class="c1"># Cheguei...; Hey</span>
</code></pre>
</div>

<h4 id="lambda-1">Lambda</h4>

<p>Já com o Lambda mesmo tendo um <code class="highlighter-rouge">return</code> ele somente executa o return no
contexto do Lambda. Dessa forma as linhas de código do método após o
Lambda são executadas como pode ver nesse exemplo:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="nf">lambda_stop</span>
  <span class="nb">puts</span> <span class="s2">"Cheguei..."</span>
  <span class="nb">lambda</span> <span class="p">{</span> <span class="nb">puts</span> <span class="s2">"Hey"</span><span class="p">;</span> <span class="k">return</span><span class="p">;</span> <span class="nb">puts</span> <span class="s2">"Ho!"</span> <span class="p">}.</span><span class="nf">call</span>
  <span class="nb">puts</span> <span class="s2">"Saindo..."</span>
<span class="k">end</span>

<span class="n">lambda_stop</span> <span class="c1"># Cheguei...; Hey; Saindo...</span>
</code></pre>
</div>

<h3 id="concluso-2">Conclusão</h3>

<p>Agora que sabemos essas duas diferenças entre os dois podemos usar essas particuliaridades de
cada um de acordo com a necessidade do nosso código.</p>

<h2 id="constantes-no-so-constantes">Constantes não são constantes</h2>

<p>Quando começei a ver sobre as constantes no Ruby que tinha a intenção de
realmente não ser alterada e me deparei com isto:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="no">CONSTANT</span> <span class="o">=</span> <span class="p">[</span><span class="ss">:a</span><span class="p">,</span> <span class="ss">:b</span><span class="p">]</span>
<span class="o">=&gt;</span> <span class="p">[</span><span class="ss">:a</span><span class="p">,</span> <span class="ss">:b</span><span class="p">]</span>

<span class="no">CONSTANT</span> <span class="o">&lt;&lt;</span> <span class="ss">:c</span>
<span class="o">=&gt;</span> <span class="p">[</span><span class="ss">:a</span><span class="p">,</span> <span class="ss">:b</span><span class="p">,</span> <span class="ss">:c</span><span class="p">]</span>
</code></pre>
</div>
<p>Bom na verdade mesmo definindo como uma constante eu posso altera-la a
qualquer momento assim como uma váriavel, minha primeira reação quanto a
isso foi esta…</p>

<p><img src="/images/posts/2016-07-25-5-coisas-que-eu-sabia-de-ruby/whatafuck.jpg" alt="ish" /></p>

<p>Com um pouco de curiosidade para saber se de alguma forma eu poderia
fazer com o que a constante não pudesse ser alterada. Tentei fazer isso
dessa forma…</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="no">CONSTANT</span> <span class="o">=</span> <span class="p">[</span><span class="ss">:a</span><span class="p">,</span> <span class="ss">:b</span><span class="p">].</span><span class="nf">freeze</span>
<span class="o">=&gt;</span> <span class="p">[</span><span class="ss">:a</span><span class="p">,</span> <span class="ss">:b</span><span class="p">]</span>

<span class="no">CONSTANT</span> <span class="o">&lt;&lt;</span> <span class="ss">:c</span>
<span class="no">RuntimeError</span><span class="p">:</span> <span class="n">can</span><span class="err">'</span><span class="n">t</span> <span class="n">modify</span> <span class="n">frozen</span> <span class="no">Array</span>
       <span class="n">from</span> <span class="p">(</span><span class="n">irb</span><span class="p">):</span><span class="mi">2</span>
       <span class="n">from</span> <span class="sr">/home/</span><span class="n">rd</span><span class="o">/</span><span class="p">.</span><span class="nf">rbenv</span><span class="o">/</span><span class="n">versions</span><span class="o">/</span><span class="mi">2</span><span class="o">.</span><span class="mi">2</span><span class="o">.</span><span class="mi">2</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">irb</span><span class="p">:</span><span class="mi">11</span><span class="ss">:in</span> <span class="sb">`&lt;main&gt;`</span>

<span class="no">CONSTANT</span>
<span class="o">=&gt;</span> <span class="p">[</span><span class="ss">:a</span><span class="p">,</span> <span class="ss">:b</span><span class="p">]</span>
</code></pre>
</div>

<p>E dessa forma com o método <code class="highlighter-rouge">freeze</code> eu não posso alterar nesse caso o
array colando mais valores nele e tudo mais…</p>

<p>Achei que tinha descoberto como realmente ter uma constante que nunca
poderá ser mudada rsrs</p>

<p>Mas ao fazer mais experimentos, consegui fazer isso…</p>

<p>Aqui sem o freeze:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="no">CONSTANT</span> <span class="o">=</span> <span class="s2">"xunda"</span>
<span class="o">=&gt;</span> <span class="s2">"xunda"</span>

<span class="no">CONSTANT</span> <span class="o">=</span> <span class="s2">"blah"</span>
<span class="p">(</span><span class="n">irb</span><span class="p">):</span><span class="mi">2</span><span class="p">:</span> <span class="ss">warning: </span><span class="n">already</span> <span class="n">initialized</span> <span class="n">constant</span> <span class="no">CONSTANT</span>
<span class="p">(</span><span class="n">irb</span><span class="p">):</span><span class="mi">1</span><span class="p">:</span> <span class="ss">warning: </span><span class="n">previous</span> <span class="n">definition</span> <span class="n">of</span> <span class="no">CONSTANT</span> <span class="n">was</span> <span class="n">here</span>
<span class="o">=&gt;</span> <span class="s2">"blah"</span>

<span class="no">CONSTANT</span>
<span class="o">=&gt;</span> <span class="s2">"blah"</span>
</code></pre>
</div>

<p>E com o freeze:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="no">CONSTANT</span> <span class="o">=</span> <span class="s2">"xunda"</span><span class="p">.</span><span class="nf">freeze</span>
<span class="o">=&gt;</span> <span class="s2">"xunda"</span>

<span class="no">CONSTANT</span> <span class="o">=</span> <span class="s2">"blah"</span>
<span class="p">(</span><span class="n">irb</span><span class="p">):</span><span class="mi">2</span><span class="p">:</span> <span class="ss">warning: </span><span class="n">already</span> <span class="n">initialized</span> <span class="n">constant</span> <span class="no">CONSTANT</span>
<span class="p">(</span><span class="n">irb</span><span class="p">):</span><span class="mi">1</span><span class="p">:</span> <span class="ss">warning: </span><span class="n">previous</span> <span class="n">definition</span> <span class="n">of</span> <span class="no">CONSTANT</span> <span class="n">was</span> <span class="n">here</span>
<span class="o">=&gt;</span> <span class="s2">"blah"</span>

<span class="no">CONSTANT</span>
<span class="o">=&gt;</span> <span class="s2">"blah"</span>
</code></pre>
</div>

<p>O que na verdade quando reiniciamos a constante ela até avisa que você
está redefinindo uma constante mas muda o valor da mesma forma com
freeze ou sem freeze nesse caso o comportamento é o mesmo.</p>

<h2 id="concluso-3">Conclusão</h2>

<p>O Ruby não o proibe de modificar as constantes dependendo do tipo do
objeto ele te avisa que está modificando uma constante porém deixa livre
para muda-la.</p>

<p>Ele trata essa questão muito mais na parte conceitual mesmo do que até
na pratica.</p>

<blockquote>
  <p>Eu consigo fazer com que uma constante não seja alterada porém não
consigo fazer com que ela não seja reinicializada</p>
</blockquote>

<p>! Pesquizar alguma formar de deixa-la inalterada porque o Jonatas falou
que tem um jeito sim</p>

<h2 id="precedncia-de-operadores-booleanos">Precedência de operadores booleanos</h2>

<p>Quando começei a ver Ruby e vi que tinha o <strong>and</strong>, <strong>&amp;&amp;</strong>, <strong>or</strong> e
<strong>||</strong> a principio pensei que o <strong>and</strong> e <strong>&amp;&amp;</strong> fossem iguais, assim
como o <strong>or</strong> e <strong>||</strong> também.</p>

<p>Porém vendo um pouco mais sobre Ruby descobri que muito pelo contrario,
são bem diferentes!</p>

<p>Vamos ver a seguir ;)</p>

<h3 id="and--">and != &amp;&amp;</h3>

<h4 id="section">&amp;&amp;</h4>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">do_something</span> <span class="o">=</span> <span class="s2">"123"</span>
<span class="o">=&gt;</span> <span class="s2">"123"</span>

<span class="n">do_other_stuff</span> <span class="o">=</span> <span class="s2">"abc"</span>
<span class="o">=&gt;</span> <span class="s2">"abc"</span>

<span class="k">if</span> <span class="n">var</span> <span class="o">=</span> <span class="n">do_something</span> <span class="o">&amp;&amp;</span> <span class="n">do_other_stuff</span>
  <span class="nb">puts</span> <span class="s2">"var is </span><span class="si">#{</span><span class="n">var</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>
<span class="n">var</span> <span class="n">is</span> <span class="n">abc</span>
<span class="o">=&gt;</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>No caso do <strong>&amp;&amp;</strong> o Ruby faz a comparação entre as duas variáveis dessa
forma:</p>

<p><code class="highlighter-rouge">var = ( do_something &amp;&amp; do_other_stuff )</code></p>

<p>Por isso ele retorna o <code class="highlighter-rouge">var</code> como abc neste caso, por que ele verifica
as duas e retorna a última no caso da duas serem <strong>true</strong>.</p>

<h4 id="and">and</h4>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">do_something</span> <span class="o">=</span> <span class="s2">"123"</span>
<span class="o">=&gt;</span> <span class="s2">"123"</span>

<span class="n">do_other_stuff</span> <span class="o">=</span> <span class="s2">"abc"</span>
<span class="o">=&gt;</span> <span class="s2">"abc"</span>

<span class="k">if</span> <span class="n">var</span> <span class="o">=</span> <span class="n">do_something</span> <span class="n">and</span> <span class="n">do_other_stuff</span>
  <span class="nb">puts</span> <span class="s2">"var is </span><span class="si">#{</span><span class="n">var</span><span class="si">}</span><span class="s2">"</span>
<span class="k">end</span>
<span class="n">var</span> <span class="n">is</span> <span class="mi">123</span>
<span class="o">=&gt;</span> <span class="kp">nil</span>
</code></pre>
</div>

<p>Já com o <strong>and</strong> é bem diferente, como vemos acima ele retorna a
variavel como <em>123</em> porque faz esse tipo de execução:</p>

<p><code class="highlighter-rouge">( var = do_something ) and do_other_stuff</code></p>

<p>Então ele já inicia sua execução atribuindo o <strong>do_something</strong> ao <code class="highlighter-rouge">var</code>
desse forma ele já retornado porque os dois são diferentes.</p>

<p>E com o <strong>or</strong> e <strong>||</strong> acontece a mesma coisa, a execução segue o mesmo
padrão, veja abaixo…</p>

<h4 id="section-1">||</h4>

<p><code class="highlighter-rouge">var = ( do_something || do_other_stuff )</code></p>

<h4 id="or">or</h4>

<p><code class="highlighter-rouge">( var = do_something or do_other_stuff )</code></p>

<p>Vendo isso a minha primeira conclusão foi em sempre utilizar o <strong>&amp;&amp;</strong>.
e <strong>||</strong>.
E esquecer que existe o <strong>and</strong> e <strong>or</strong> senão… kkk</p>

<iframe src="//giphy.com/embed/sCKxksj4A8Tg4" width="480" height="310" frameborder="0" class="giphy-embed" allowfullscreen=""></iframe>

<h3 id="avdi-grimm">Avdi Grimm</h3>

<p>Inconformado com a falta de utilidade que tinha o <strong>and</strong> e <strong>or</strong> no
Ruby começei a pesquisar mais sobre esse assunto porque não acreditava
que não tinha nenhuma utilidade e queria saber como utilizar e quando é melhor
utilizar do que o <strong>&amp;&amp;</strong> e <strong>||</strong>.</p>

<p>E nessa busca achei um post de um cara bem conhecido da comunidade Ruby
o <a href="http://www.virtuouscode.com/about/" target="_blank">Avdi Grimm</a> e
ele nesse post <a href="http://www.virtuouscode.com/2010
/08/02/using-and-and-or-in-ruby/" target="_blank">Using “and” and “or” in Ruby</a>.</p>

<p>Nesse artigo ele explica bem a diferença dos operadores e que o <strong>and</strong>
e <strong>or</strong> do Ruby vieram do Perl.
E no Perl eles tem o objetivo de serem utilizados
para controlar o fluxo da aplicação e assim como o <strong>if</strong> e <strong>unless</strong>.</p>

<p><code class="highlighter-rouge">do_something() or die "It didn't work"</code></p>

<p>No Ruby eles tem esse mesmo proposito de controlar o fluxo da operação e
não de ser um operador booleano.</p>

<p>Bom, vamos ver mais alguns exemplos sobre como utilizar para controlar o
fluxo da operação</p>

<h3 id="or-1">or</h3>

<p>No exemplo abaixo, podemos ver que é possivel utilizar o <code class="highlighter-rouge">or</code> tendo a
primeira condição com um retorno boolean neste caso o <code class="highlighter-rouge">post.have_posts?</code>
e logo após a ação que ele irá fazer.
Então se essa primeira condição retornar <strong>true</strong> ele nem executa a
segunda ação e caso retorne <strong>false</strong> ele a executa.</p>

<p>Nesse caso teria mais um sentido de faça isso <strong>ou</strong> faça aquilo</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Post</span>
  <span class="k">def</span> <span class="nf">have_posts?</span>
    <span class="kp">false</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">post</span> <span class="o">=</span> <span class="no">Post</span><span class="p">.</span><span class="nf">new</span>
<span class="n">post</span><span class="p">.</span><span class="nf">have_posts?</span> <span class="n">or</span> <span class="k">raise</span> <span class="s2">"Não tem posts!"</span>
<span class="c1">#=&gt; RuntimeError: Não tem posts!</span>
</code></pre>
</div>

<p>O comportamento é muito similiar a ter um <code class="highlighter-rouge">unless</code> como abaixo:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">raise</span> <span class="s2">"Não tem posts!"</span> <span class="k">unless</span> <span class="n">post</span><span class="p">.</span><span class="nf">have_posts?</span>
<span class="c1">#=&gt; RuntimeError: Não tem posts!</span>
</code></pre>
</div>

<h3 id="and-1">and</h3>

<p>Utilizando o <code class="highlighter-rouge">and</code> o comportamento é igual na questão de precedência a
diferença é que para ele executar a segunda ação a primeira tem que
retornar <code class="highlighter-rouge">true</code></p>

<p>Nesse caso o sentido é mais de faça isso <strong>e</strong> aquilo</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Post</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
    <span class="vi">@name</span> <span class="o">=</span> <span class="nb">name</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">publish!</span>
    <span class="nb">puts</span> <span class="s2">"Post </span><span class="si">#{</span><span class="vi">@name</span><span class="si">}</span><span class="s2"> publicado!"</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">post</span> <span class="o">=</span> <span class="no">Post</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"5 dicas de Ruby"</span><span class="p">)</span> <span class="n">and</span> <span class="n">post</span><span class="p">.</span><span class="nf">publish!</span>
<span class="c1">#=&gt; Post 5 dicas de Ruby publicado!</span>
</code></pre>
</div>

<p>Nesse caso, o comportamente é igual ao utilizar um <code class="highlighter-rouge">if</code> como abaixo:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">post</span><span class="p">.</span><span class="nf">publish!</span> <span class="k">if</span> <span class="n">post</span> <span class="o">=</span> <span class="no">Post</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"5 dicas de Ruby"</span><span class="p">)</span>
<span class="c1">#=&gt; Post 5 dicas de Ruby publicado!</span>
</code></pre>
</div>

<p><strong>No rails</strong></p>

<p>Um exemplo legal para utilizar o <code class="highlighter-rouge">and</code> no rails seria esse:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">post</span> <span class="o">=</span> <span class="no">Post</span><span class="p">.</span><span class="nf">find_by_name</span><span class="p">(</span><span class="s2">"5 dicas de Ruby"</span><span class="p">)</span> <span class="n">and</span> <span class="n">post</span><span class="p">.</span><span class="nf">publish!</span>
<span class="c1">#=&gt; Post 5 dicas de Ruby publicado!</span>
</code></pre>
</div>

<p>Onde ele busca o post e caso o encontre ele publica ;)</p>

<h2 id="concluso-4">Conclusão</h2>

<p>Sobre o uso de <code class="highlighter-rouge">and</code> e <code class="highlighter-rouge">or</code> certamente é não utiliza-los no lugar de <code class="highlighter-rouge">&amp;&amp;</code> e <code class="highlighter-rouge">||</code>
pois como vimos acima são diferentes então sabendo disso é possivel
tirar melhor proveito deles para dependendo do caso ter um código mais
legivel.</p>


  </section>
  
</article>



      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2016 Wagner Trindade. All rights reserved.</span>
</footer> 

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js"></script>

    </div>
  </body>
</html>